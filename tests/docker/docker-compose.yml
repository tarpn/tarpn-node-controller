services:
  alice:
    image: tarpn/tarpn-test:latest
    environment:
      - SOCAT_ARGS=PTY,raw,echo=1,link=/tmp/vmodem_A0 udp:bob:12345|PTY,raw,echo=1,link=/tmp/vmodem_B1 udp-listen:10000
      - SLEEP=3
    volumes:
      - ./config/alice.ini:/opt/tarpn/config/node.ini
      - /tmp/socks/:/tmp/socks/
    command: /opt/tarpn/bin/launch-tarpn.sh
  bob:
    image: tarpn/tarpn-test:latest
    environment:
      - SOCAT_ARGS=PTY,raw,echo=1,link=/tmp/vmodem_A1 udp-listen:12345
    volumes:
      - ./config/bob.ini:/opt/tarpn/config/node.ini
      - /tmp/socks/:/tmp/socks/
    command: /opt/tarpn/bin/launch-tarpn.sh
  carol:
    image: tarpn/tarpn-test:latest
    environment:
      - SOCAT_ARGS=PTY,raw,echo=1,link=/tmp/vmodem_B0 udp:alice:10000
      - SLEEP=1
    volumes:
      - ./config/carol.ini:/opt/tarpn/config/node.ini
      - /tmp/socks/:/tmp/socks/
    command: /opt/tarpn/bin/launch-tarpn.sh
